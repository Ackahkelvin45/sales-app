{% extends 'chrisco/layout.html'%}
{% load static %}
{%block body%}
<div class="w-full max-1xl:pl-[25%] max-md:pl-[33%] max-900px:pl-[28%]  pl-[20%] max-sm:pl-0  transform duration-500 mt-16 overflow-x-hidden" id="index-body">
    <div class="w-full  flex-col  items-center flex ">
        <div class="w-full h-52 bg-gradient-to-br from-green-500 to-slate-400 flex flex-col p-10 text-gray-100">
            <div class="w-full flex flex-row">
               <svg  version="1.0" xmlns="http://www.w3.org/2000/svg"  class="400px:h-[50px] 400px:w-[50px] w-[30px] h-[30px]" viewBox="0 0 100.000000 100.000000"  preserveAspectRatio="xMidYMid meet">  <g transform="translate(0.000000,100.000000) scale(0.100000,-0.100000)" fill="#f3f6f4" stroke="none"> <path d="M424 835 c-17 -9 -51 -36 -75 -61 l-44 -45 -2 -94 c-1 -75 3 -102 18 -132 10 -20 19 -45 19 -55 0 -10 18 -38 41 -63 22 -24 39 -49 37 -56 -2 -6 -35 -23 -73 -38 -74 -28 -115 -70 -115 -117 l0 -24 270 0 270 0 0 23 c0 32 -35 84 -67 100 -15 8 -48 21 -72 28 -23 7 -45 19 -48 26 -3 7 13 33 36 58 22 24 41 53 41 63 0 10 9 35 20 57 20 40 26 76 13 89 -4 4 -6 27 -4 52 2 28 -3 54 -13 69 -10 15 -12 26 -6 30 21 13 7 31 -48 65 -67 41 -147 51 -198 25z m182 -38 c27 -18 48 -39 46 -47 -2 -7 2 -25 8 -40 6 -15 10 -47 8 -71 l-4 -44 -13 47 c-17 62 -26 68 -84 57 -54 -10 -114 0 -151 24 -23 16 -24 15 -50 -42 -14 -32 -26 -67 -26 -77 0 -16 -2 -17 -10 -4 -14 22 -12 97 4 128 13 25 54 61 101 89 11 7 43 12 71 13 42 0 61 -6 100 -33z m-161 -101 c31 -14 55 -17 107 -13 l67 6 10 -32 c5 -18 13 -47 16 -65 6 -27 9 -31 21 -21 8 6 14 7 14 2 0 -21 -22 -73 -31 -73 -5 0 -9 -14 -9 -32 0 -24 -10 -41 -44 -74 -54 -51 -92 -62 -140 -39 -50 24 -96 79 -96 115 0 17 -4 30 -9 30 -9 0 -31 52 -31 73 0 5 7 4 15 -3 12 -10 15 -9 15 6 0 25 42 145 49 141 3 -2 24 -11 46 -21z m85 -359 c26 10 30 9 30 -7 0 -24 15 -35 81 -59 55 -21 90 -50 102 -83 6 -17 -10 -18 -243 -18 -233 0 -249 1 -243 18 21 60 116 103 209 96 62 -4 63 0 3 10 -31 6 -36 9 -32 30 4 22 7 23 34 13 21 -8 37 -8 59 0z"/> <path d="M390 630 c0 -5 20 -10 45 -10 25 0 45 5 45 10 0 6 -20 10 -45 10 -25 0 -45 -4 -45 -10z"/> <path d="M520 630 c0 -5 20 -10 45 -10 25 0 45 5 45 10 0 6 -20 10 -45 10 -25 0 -45 -4 -45 -10z"/> <path d="M426 585 c4 -9 1 -15 -7 -15 -10 0 -10 -3 -1 -12 9 -9 15 -9 23 -1 13 13 5 43 -10 43 -6 0 -8 -7 -5 -15z"/> <path d="M566 585 c4 -9 1 -15 -7 -15 -10 0 -10 -3 -1 -12 9 -9 15 -9 23 -1 13 13 5 43 -10 43 -6 0 -8 -7 -5 -15z"/> <path d="M428 419 c18 -19 126 -19 144 0 11 11 9 12 -12 5 -32 -11 -88 -11 -120 0 -21 7 -23 6 -12 -5z"/> </g> </svg> 
            <span class="mx-2 400px:text-3xl  text-lg   mt-1">All Users  </span>
            
            </div>
            
        </div>

        <div class="w-[95%] h-screen bg-gray-100 z-10 -mt-20 rounded-md flex flex-col p-10 text-gray-600 mb-14 overflow-x-auto">
            <table class="products-table text-green-600" id="products-table" >
                <thead >
                    <tr class="text-left">
                        <th>id</th>
                        <th>username</th>
                        <th>phone number</th>
                      
                        <th>Action</th>
                    </tr>
                
                </thead>
                <tbody>

                    {% for user in  users%}
                    <tr>
                       
                        <td>{{user.id}}</td>
                        <td>{{user.username}}</td>
                        <td>{{user.phone_number}}</td>
                       
                       
                        <td>
                           
                            <button class="bg-red-600 text-white rounded-md px-2 delete-user" data-url="{% url 'auth:delete-user' user.id%}"  type="button">delete</button>
                            <a href="{% url 'auth:view-detail' user.id %}" type="button " class="text-white rounded-md px-2 bg-cyan-600" >View</a>
                        </td>
                      
                    </tr>
                {%endfor%}
                    </tbody>
            </table>
            
 
        </div>
      
        </div>

    </div>
    <script src="{% static 'js/datatable.js' %}"></script>
    {% for message in messages %}
    {% if messages  %}
      <!-- sweetalert js -->
      <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
      <script>
        var m = "{{ message }}";
        Swal.fire({
          icon: 'success',
          text: m,
          confirmButtonColor: '#26A69A',
          showConfirmButton:false,
          allowEscapeKey: false,
          background: '#727272',
          color:"white",
          timer:1500,
          showClass: {
            popup: 'my-icon'                     // disable popup animation css
          },
         
        });
      </script>
      

    {% endif %}
  {% endfor %}
  <script>
    let deleteitem=document.querySelectorAll('.delete-user');
    console.log(deleteitem)
    for (var i=0; i<deleteitem.length; i++){
       
       
    deleteitem[i].addEventListener('click',(e)=>{
        Swal.fire({
       icon: 'warning',
       text: "Are you sure?",
       title:"delete",
       showConfirmButton:true,
       showCancelButton:true,
       confirmButtonColor: '#4ade80',
       confirmButtonText:"Yes",
       color:"white",
       background: 'rgba(0, 0, 0, 0.7)',
       allowEscapeKey: false,

      
     }).then((result) => {
       /* Read more about isConfirmed, isDenied below */
       if (result.isConfirmed) {
          
           log=e.target.getAttribute("data-url")
           window.location.href=log

       } else if (result.isDenied) {
        
       }
     })


    })
       
    
    }
    

  </script>
  {%if  view_details  %}
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
   
    Swal.fire({
       
      text: "User Details",
      confirmButtonColor: '#26A69A',
      showConfirmButton:true,
      allowEscapeKey: false,
      background: '#727272',
      html:"<div class='w-full flex flex-col justify-center items-center'><img src='{% static 'img/user.png'%}'/><div class='w-full flex flex-col justify-center items-center'><div class='flex md:flex-row flex-col'><span class='font-bold'>First Name:</span ><span>{{user.first_name}}</span></div> <div class=' my-4 flex md:flex-row flex-col'><span class='font-bold'>Last Name:</span ><span>{{user.last_name}}</span></div> <div class='flex md:flex-row flex-col'><span class='font-bold'>Username:</span ><span>{{user.username}}</span></div><div class=' my-4 flex md:flex-row flex-col'><span class='font-bold'>Phone Number:</span ><span>{{user.phone_number}}</span></div> <div class='  flex md:flex-row flex-col'><span class='font-bold'>Is Admin:</span ><span>{{user.is_superuser}}</span></div>  </div ></div>",
      color:"white",
      showClass: {
        popup: 'my-icon'                     // disable popup animation css
      },
     
    }).then((result) => {
       /* Read more about isConfirmed, isDenied below */
       if (result.isConfirmed) {
        window.location.href = "{%  url  'auth:view-users'%}"
       } else if (result.isDenied) {
        
       }
     })
  </script>
  {%endif%}
{%endblock%}